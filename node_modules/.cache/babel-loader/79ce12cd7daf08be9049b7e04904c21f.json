{"remainingRequest":"/Users/fanpenglei/Study/Code/cesium-demoV1.1/node_modules/_babel-loader@8.2.5@babel-loader/lib/index.js!/Users/fanpenglei/Study/Code/cesium-demoV1.1/src/assets/js/entityCluster.js","dependencies":[{"path":"/Users/fanpenglei/Study/Code/cesium-demoV1.1/src/assets/js/entityCluster.js","mtime":1658209505000},{"path":"/Users/fanpenglei/Study/Code/cesium-demoV1.1/babel.config.js","mtime":1658370777000},{"path":"/Users/fanpenglei/Study/Code/cesium-demoV1.1/node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fanpenglei/Study/Code/cesium-demoV1.1/node_modules/_babel-loader@8.2.5@babel-loader/lib/index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:dmFyIENlc2l1bSA9IHJlcXVpcmUoImNlc2l1bS9DZXNpdW0iKTsKCmltcG9ydCBiaWxsYm9hcmQgZnJvbSAiLi4vaW1nL2JpbGxib2FyZC5wbmciOwpsZXQgZGF0YVNvdXJjZSA9IG51bGw7CmxldCByZW1vdmVMaXN0ZW5lcjsKbGV0IHBpeGVsUmFuZ2U7CmxldCBtaW5pbXVtQ2x1c3RlclNpemU7CmxldCBlbmFibGVkOwpsZXQgY3VzdG9tRGF0YVNvdXJjZTsKZXhwb3J0IGZ1bmN0aW9uIGVudGl0eUNsdXN0ZXIodmlld2VyKSB7CiAgY3VzdG9tRGF0YVNvdXJjZSA9IG5ldyBDZXNpdW0uQ3VzdG9tRGF0YVNvdXJjZSgiY3VzdG9tRGF0YVNvdXJjZSIpOwogIGNvbnNvbGUubG9nKGN1c3RvbURhdGFTb3VyY2UpOwoKICBmb3IgKGxldCBpID0gMDsgaSA8IDI1MDsgaSsrKSB7CiAgICBsZXQgZW50aXR5ID0gbmV3IENlc2l1bS5FbnRpdHkoKTsKICAgIGNvbnNvbGUubG9nKGVudGl0eSk7CiAgICBlbnRpdHkucG9zaXRpb24gPSBDZXNpdW0uQ2FydGVzaWFuMy5mcm9tRGVncmVlcyhDZXNpdW0uTWF0aC5yYW5kb21CZXR3ZWVuKC0xODAsIDE4MCksIENlc2l1bS5NYXRoLnJhbmRvbUJldHdlZW4oLTc1LCA3NSkpOwogICAgY29uc29sZS5sb2coZW50aXR5LnBvc2l0aW9uKTsKICAgIGVudGl0eS5iaWxsYm9hcmQgPSBuZXcgQ2VzaXVtLkJpbGxib2FyZEdyYXBoaWNzKCk7CiAgICBlbnRpdHkuYmlsbGJvYXJkLmltYWdlID0gYmlsbGJvYXJkOwogICAgZW50aXR5LmJpbGxib2FyZC5jb2xvciA9IENlc2l1bS5Db2xvci5mcm9tUmFuZG9tKCkud2l0aEFscGhhKDAuOCk7CiAgICBjdXN0b21EYXRhU291cmNlLmVudGl0aWVzLmFkZChlbnRpdHkpOwogICAgY29uc29sZS5sb2coZW50aXR5LmJpbGxib2FyZCk7CiAgfQoKICB2aWV3ZXIuZGF0YVNvdXJjZXMuYWRkKGN1c3RvbURhdGFTb3VyY2UpOyAvLyBjb25zb2xlLmxvZyh2aWV3ZXIuZGF0YVNvdXJjZXMuYWRkKGN1c3RvbURhdGFTb3VyY2UpKQoKICBkYXRhU291cmNlID0gY3VzdG9tRGF0YVNvdXJjZTsKICBwaXhlbFJhbmdlID0gNTsKICBtaW5pbXVtQ2x1c3RlclNpemUgPSAzOwogIGVuYWJsZWQgPSB0cnVlOwogIHJlbW92ZUxpc3RlbmVyID0gbnVsbDsgLy/lvIDlkK/mlbDmja7mupDlrp7kvZPogZrlkIgKCiAgZGF0YVNvdXJjZS5jbHVzdGVyaW5nLmVuYWJsZWQgPSBlbmFibGVkOyAvL+aJqeWxleWxj+W5leepuumXtOi+ueahhueahOWDj+e0oOiMg+WbtAoKICBkYXRhU291cmNlLmNsdXN0ZXJpbmcucGl4ZWxSYW5nZSA9IHBpeGVsUmFuZ2U7IC8v576k6ZuG55qE5bGP5bmV56m66Ze05a+56LGh55qE5pyA5bCP5pWw6YePCgogIGRhdGFTb3VyY2UuY2x1c3RlcmluZy5taW5pbXVtQ2x1c3RlclNpemUgPSBtaW5pbXVtQ2x1c3RlclNpemU7Cn0gLy/mt7vliqDogZrlkIgKCmV4cG9ydCBmdW5jdGlvbiBjdXN0b21TdHlsZSgpIHsKICBsZXQgcmVtb3ZlTGlzdGVuZXIgPSBudWxsOwoKICBpZiAoQ2VzaXVtLmRlZmluZWQocmVtb3ZlTGlzdGVuZXIpKSB7CiAgICByZW1vdmVMaXN0ZW5lcigpOwogICAgcmVtb3ZlTGlzdGVuZXIgPSB1bmRlZmluZWQ7CiAgfSBlbHNlIHsKICAgIHJlbW92ZUxpc3RlbmVyID0gZGF0YVNvdXJjZS5jbHVzdGVyaW5nLmNsdXN0ZXJFdmVudC5hZGRFdmVudExpc3RlbmVyKGZ1bmN0aW9uIChjbHVzdGVyZWRFbnRpdGllcywgY2x1c3RlcikgewogICAgICBjbHVzdGVyLmxhYmVsLnNob3cgPSB0cnVlOwogICAgICBjbHVzdGVyLmxhYmVsLnRleHQgPSBjbHVzdGVyZWRFbnRpdGllcy5sZW5ndGgudG9TdHJpbmcoKTsKICAgICAgY2x1c3Rlci5sYWJlbC5waXhlbE9mZnNldCA9IG5ldyBDZXNpdW0uQ2FydGVzaWFuMigtNSwgNSk7CiAgICAgIGNsdXN0ZXIubGFiZWwuZm9udCA9ICIxOHB4IHNhbnMtc2VyaWYiOwogICAgICBjbHVzdGVyLmxhYmVsLnN0eWxlID0gQ2VzaXVtLkxhYmVsU3R5bGUuRklMTF9BTkRfT1VUTElORTsKICAgICAgY2x1c3Rlci5sYWJlbC5maWxsQ29sb3IgPSBDZXNpdW0uQ29sb3IuUkVEOwogICAgICBjbHVzdGVyLmxhYmVsLm91dGxpbmVDb2xvciA9IENlc2l1bS5Db2xvci5CTEFDSzsKICAgICAgY2x1c3Rlci5sYWJlbC5vdXRsaW5lV2lkdGggPSAyOwogICAgICBjbHVzdGVyLmJpbGxib2FyZC5zaG93ID0gdHJ1ZTsKICAgICAgY2x1c3Rlci5iaWxsYm9hcmQuaWQgPSBjbHVzdGVyLmxhYmVsLmlkOwogICAgICBjbHVzdGVyLmJpbGxib2FyZC5pbWFnZSA9IGJpbGxib2FyZDsKICAgIH0pOwogIH0gLy8g5by65Yi26IGa5ZCI5L2/55So5paw55qE5qC35byPCgoKICBsZXQgcGl4ZWxSYW5nZSA9IGRhdGFTb3VyY2UuY2x1c3RlcmluZy5waXhlbFJhbmdlOwogIGRhdGFTb3VyY2UuY2x1c3RlcmluZy5waXhlbFJhbmdlID0gMDsKICBkYXRhU291cmNlLmNsdXN0ZXJpbmcucGl4ZWxSYW5nZSA9IHBpeGVsUmFuZ2U7Cn0gLy/muIXpmaQgZGF0YVNvdXJjZXMKCmV4cG9ydCBmdW5jdGlvbiBjbGVhckVudGl0eUNsdXN0ZXIodmlld2VyKSB7CiAgdmlld2VyLmRhdGFTb3VyY2VzLnJlbW92ZShjdXN0b21EYXRhU291cmNlKTsKfQ=="},{"version":3,"names":["Cesium","require","billboard","dataSource","removeListener","pixelRange","minimumClusterSize","enabled","customDataSource","entityCluster","viewer","CustomDataSource","console","log","i","entity","Entity","position","Cartesian3","fromDegrees","Math","randomBetween","BillboardGraphics","image","color","Color","fromRandom","withAlpha","entities","add","dataSources","clustering","customStyle","defined","undefined","clusterEvent","addEventListener","clusteredEntities","cluster","label","show","text","length","toString","pixelOffset","Cartesian2","font","style","LabelStyle","FILL_AND_OUTLINE","fillColor","RED","outlineColor","BLACK","outlineWidth","id","clearEntityCluster","remove"],"sources":["/Users/fanpenglei/Study/Code/cesium-demoV1.1/src/assets/js/entityCluster.js"],"sourcesContent":["var Cesium = require(\"cesium/Cesium\");\nimport billboard from \"../img/billboard.png\";\nlet dataSource = null;\nlet removeListener;\nlet pixelRange;\nlet minimumClusterSize;\nlet enabled;\nlet customDataSource;\nexport function entityCluster(viewer) {\n  customDataSource = new Cesium.CustomDataSource(\"customDataSource\");\n  console.log(customDataSource);\n  for (let i = 0; i < 250; i++) {\n    let entity = new Cesium.Entity();\n    console.log(entity);\n    entity.position = Cesium.Cartesian3.fromDegrees(\n      Cesium.Math.randomBetween(-180, 180),\n      Cesium.Math.randomBetween(-75, 75)\n    );\n    console.log(entity.position);\n    entity.billboard = new Cesium.BillboardGraphics();\n\n    entity.billboard.image = billboard;\n    entity.billboard.color = Cesium.Color.fromRandom().withAlpha(0.8);\n    customDataSource.entities.add(entity);\n    console.log(entity.billboard);\n  }\n  viewer.dataSources.add(customDataSource);\n  // console.log(viewer.dataSources.add(customDataSource))\n  dataSource = customDataSource;\n  pixelRange = 5;\n  minimumClusterSize = 3;\n  enabled = true;\n  removeListener = null;\n  //开启数据源实体聚合\n  dataSource.clustering.enabled = enabled;\n  //扩展屏幕空间边框的像素范围\n  dataSource.clustering.pixelRange = pixelRange;\n  //群集的屏幕空间对象的最小数量\n  dataSource.clustering.minimumClusterSize = minimumClusterSize;\n}\n\n//添加聚合\nexport function customStyle() {\n  let removeListener = null;\n  if (Cesium.defined(removeListener)) {\n    removeListener();\n    removeListener = undefined;\n  } else {\n    removeListener = dataSource.clustering.clusterEvent.addEventListener(\n      function (clusteredEntities, cluster) {\n        cluster.label.show = true;\n        cluster.label.text = clusteredEntities.length.toString();\n        cluster.label.pixelOffset = new Cesium.Cartesian2(-5, 5);\n        cluster.label.font = \"18px sans-serif\";\n        cluster.label.style = Cesium.LabelStyle.FILL_AND_OUTLINE;\n        cluster.label.fillColor = Cesium.Color.RED;\n        cluster.label.outlineColor = Cesium.Color.BLACK;\n        cluster.label.outlineWidth = 2;\n        cluster.billboard.show = true;\n        cluster.billboard.id = cluster.label.id;\n        cluster.billboard.image = billboard;\n      }\n    );\n  }\n  // 强制聚合使用新的样式\n  let pixelRange = dataSource.clustering.pixelRange;\n  dataSource.clustering.pixelRange = 0;\n  dataSource.clustering.pixelRange = pixelRange;\n}\n\n//清除 dataSources\nexport function clearEntityCluster(viewer){\n  viewer.dataSources.remove(customDataSource);\n}"],"mappings":"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"}]}